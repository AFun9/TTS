# Sherpa TTS Android - 用户指南

## 1. 应用概述

Sherpa TTS 是一款基于深度学习的语音合成应用，支持跨语言发音控制。通过自定义词典，您可以使用任何语言训练的模型来生成其他语言的发音。

## 2. 快速开始

### 2.1 安装应用

1. 从 Google Play 下载安装 Sherpa TTS
2. 首次启动时授予存储权限

### 2.2 导入模型

1. 打开应用，点击"模型管理"
2. 点击"导入模型"选择 ONNX 模型文件
3. 导入对应的 tokens.txt 文件
4. （可选）导入词典文件 lexicon.txt

### 2.3 生成语音

1. 在主界面输入文本
2. 点击"生成语音"按钮
3. 等待生成完成后自动播放

## 3. 详细功能说明

### 3.1 主界面

#### 文本输入
- 支持多行文本输入
- 自动检测输入语言
- 支持从文件导入文本

#### 语音控制
- **生成语音**: 将文本转换为语音
- **停止播放**: 停止当前播放
- **播放控制**: 暂停/继续播放

#### 参数调节
- **语速**: 0.5x - 2.0x 调节范围
- **音量**: 0-100% 音量控制

#### 文件操作
- **导入文本**: 从 TXT/CSV 文件导入
- **导出音频**: 将生成的语音保存为 WAV 文件

### 3.2 模型管理

#### 导入模型
1. 点击"导入模型"
2. 选择 ONNX 格式的模型文件
3. 等待模型验证完成
4. 查看模型信息（采样率、说话人数量等）

#### 模型信息
- **采样率**: 音频采样率（如 22050Hz）
- **说话人数量**: 支持的说话人数量
- **语言**: 模型训练语言
- **文件大小**: 模型文件大小

#### 切换模型
- 在模型列表中选择要使用的模型
- 当前使用的模型会高亮显示

### 3.3 词典编辑器

#### 查看词典
- 显示当前加载词典的所有条目
- 支持按单词搜索
- 显示发音映射关系

#### 编辑条目
1. 点击"添加"创建新条目
2. 输入单词和对应的音素序列
3. 点击"保存"确认修改

#### 词典格式
每行一个映射关系：
```
单词 音素1 音素2 音素3 ...
```

示例：
```
hello h ɛ l o
world w ɜ r l d
```

#### 导入导出
- **导入词典**: 从 TXT 文件导入词典条目
- **导出词典**: 将当前词典保存为文件

### 3.4 设置

#### 音频设置
- **采样率**: 输出音频采样率
- **格式**: 音频输出格式（WAV）

#### 性能设置
- **线程数**: 推理使用的 CPU 线程数
- **调试模式**: 启用详细日志输出

## 4. 高级用法

### 4.1 跨语言发音

#### 场景：用俄语模型生成英语发音

1. **准备模型**: 导入俄语训练的 VITS 模型
2. **创建词典**: 将英语单词映射到俄语音素
   ```
   hello х э л о
   world в о р л д
   ```
3. **生成语音**: 输入英语文本，输出俄语风味的英语发音

#### 词典创建建议
- 使用国际音标 (IPA) 作为中间表示
- 参考目标语言的音素到源语言音素的映射表
- 逐步添加常用词汇，测试发音效果

### 4.2 批量处理

#### 文本文件格式
支持多种文本文件格式：

**纯文本 (TXT)**
```
Hello world
How are you?
```

**CSV 格式**
```csv
text
"Hello world"
"How are you?"
```

#### 批量导出
1. 从文件导入多个文本
2. 逐个生成语音
3. 批量导出所有音频文件

### 4.3 自定义发音

#### 品牌词发音
为特定品牌词定制发音：
```
Coca-Cola k o ʊ k ɑ k o l ə
iPhone aɪ f oʊ n
```

#### 专有名词
处理人名、地名等特殊发音：
```
Paris p æ ɹ ɪ s
Beijing b eɪ ʒ ɪ ŋ
```

## 5. 故障排除

### 5.1 常见问题

#### 应用启动失败
- **原因**: 权限不足或存储空间不足
- **解决**:
  1. 检查存储权限是否已授予
  2. 清理应用缓存和数据
  3. 确保至少 500MB 可用空间

#### 模型导入失败
- **原因**: 模型文件损坏或格式不支持
- **解决**:
  1. 检查模型文件是否完整
  2. 确认模型格式为 ONNX
  3. 查看应用日志获取详细错误信息

#### 语音生成失败
- **原因**: 模型配置错误或内存不足
- **解决**:
  1. 检查模型和词典文件是否正确加载
  2. 尝试减少线程数
  3. 重启应用释放内存

#### 词典格式错误
- **原因**: 音素符号不在 tokens.txt 中
- **解决**:
  1. 检查词典中的音素是否正确
  2. 参考 tokens.txt 中的可用音素
  3. 使用词典验证功能检查格式

### 5.2 性能优化

#### 内存使用过高
- 减少同时加载的模型数量
- 使用更小的模型文件
- 定期清理缓存文件

#### 生成速度慢
- 降低线程数（某些设备上过多线程会更慢）
- 使用更简单的模型
- 避免过长的文本输入

### 5.3 日志查看

#### 启用调试模式
1. 进入设置页面
2. 开启"调试模式"
3. 查看应用日志获取详细错误信息

#### 日志位置
- Android 11+: `设置 > 应用 > Sherpa TTS > 存储 > 清除存储`
- 较老版本: `/data/data/com.k2fsa.sherpa.tts/files/logs/`

## 6. 最佳实践

### 6.1 模型选择

#### 根据使用场景选择模型
- **通用对话**: 使用多说话人模型
- **有声书**: 选择高采样率模型
- **实时应用**: 使用轻量级模型

#### 模型文件管理
- 定期备份重要的模型文件
- 为不同用途准备专门的模型
- 及时删除不再使用的模型释放空间

### 6.2 词典管理

#### 词典组织
- 按语言分类存储词典文件
- 使用有意义的命名约定
- 定期更新和维护词典

#### 发音测试
- 为新词典条目单独测试发音
- 对比有词典和无词典的发音差异
- 收集用户反馈持续优化

### 6.3 存储管理

#### 文件组织
- 使用有意义的目录结构
- 定期清理临时文件
- 备份重要的音频输出

#### 空间管理
- 监控应用存储使用情况
- 及时删除不需要的音频文件
- 考虑使用外部存储保存大文件

## 7. 隐私和安全

### 7.1 数据处理
- **本地处理**: 所有语音合成在本地进行
- **不联网**: 应用不需要网络权限
- **隐私保护**: 不收集或上传用户数据

### 7.2 权限说明
- **存储权限**: 用于导入模型/词典和导出音频
- **音频权限**: 用于播放生成的语音
- **按需申请**: 仅在需要时请求权限

### 7.3 数据安全
- **文件访问**: 严格限制在用户指定的目录
- **缓存清理**: 定期清理临时文件
- **数据隔离**: 不同应用的模型文件相互隔离

## 8. 更新和支持

### 8.1 版本更新
- 通过 Google Play 自动更新
- 新版本会保持向后兼容
- 重要更新会通过应用内通知

### 8.2 技术支持
- **问题反馈**: 通过应用内反馈功能
- **文档**: 在线文档持续更新
- **社区**: 加入用户社区获取帮助

### 8.3 已知限制
- 当前版本不支持实时流式合成
- 模型文件需要手动导入
- 某些特殊字符可能需要转义

## 9. 附录

### 9.1 支持的文件格式

#### 模型文件
- **ONNX**: Open Neural Network Exchange 格式
- **推荐大小**: < 500MB
- **支持架构**: VITS, Matcha, Kokoro 等

#### 文本文件
- **编码**: UTF-8
- **格式**: TXT, CSV, JSON
- **大小限制**: < 10MB

#### 词典文件
- **格式**: 纯文本，每行一个映射
- **音素限制**: 必须在 tokens.txt 中存在

### 9.2 系统要求

#### 最低配置
- **Android 版本**: 7.0 (API 24)
- **RAM**: 2GB
- **存储**: 1GB 可用空间

#### 推荐配置
- **Android 版本**: 10.0+
- **RAM**: 4GB+
- **存储**: 2GB+ 可用空间
- **CPU**: 支持 ARM64

### 9.3 术语表

- **TTS**: Text-to-Speech，文本到语音转换
- **VITS**: Variational Inference with adversarial learning for Text-to-Speech
- **ONNX**: Open Neural Network Exchange 格式
- **Lexicon**: 发音词典，将单词映射到音素序列
- **Phonemizer**: 将文本转换为音素的工具
- **IPA**: International Phonetic Alphabet，国际音标